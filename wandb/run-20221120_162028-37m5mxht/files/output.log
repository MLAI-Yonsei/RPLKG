Loading trainer: ZeroshotCLIP
Loading dataset: ImageNet
Traceback (most recent call last):
  File "train.py", line 257, in <module>
    main(args)
  File "train.py", line 178, in main
    trainer = build_trainer(cfg)
  File "/mlainas/yewon/CoOp/CoOp/KGPrompt/dassl/engine/build.py", line 11, in build_trainer
    return TRAINER_REGISTRY.get(cfg.TRAINER.NAME)(cfg)
  File "/mlainas/yewon/CoOp/CoOp/KGPrompt/dassl/engine/trainer.py", line 344, in __init__
    self.build_data_loader()
  File "/mlainas/yewon/CoOp/CoOp/KGPrompt/dassl/engine/trainer.py", line 424, in build_data_loader
    train_data = CustomImageDataset(image_feat_train, label_train)
UnboundLocalError: local variable 'image_feat_train' referenced before assignment
Building transform_train
+ random resized crop (size=(224, 224), scale=(0.08, 1.0))
+ random flip
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
Building transform_test
+ resize the smaller edge to 224
+ 224x224 center crop
+ to torch tensor of range [0, 1]
+ normalization (mean=[0.48145466, 0.4578275, 0.40821073], std=[0.26862954, 0.26130258, 0.27577711])
---------  ---------
Dataset    ImageNet
# classes  1,000
# train_x  1,281,167
# val      50,000
# test     50,000
---------  ---------
/mlainas/KGPrompt_data/imagenet/shot_-1_seed_1_train.npy
/mlainas/KGPrompt_data/imagenet/shot_-1_seed_1_valid.npy